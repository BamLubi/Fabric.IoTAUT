(function(e){function t(t){for(var i,s,r=t[0],n=t[1],c=t[2],u=0,p=[];u<r.length;u++)s=r[u],l[s]&&p.push(l[s][0]),l[s]=0;for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);d&&d(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],i=!0,r=1;r<a.length;r++){var n=a[r];0!==l[n]&&(i=!1)}i&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var i={},l={app:0},o=[];function s(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=i,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],n=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=n;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var i=a("64a9"),l=a.n(i);l.a},"0a41":function(e,t,a){},1565:function(e,t,a){},"19e7":function(e,t,a){},"27bb":function(e,t,a){"use strict";var i=a("0a41"),l=a.n(i);l.a},"44ee":function(e,t,a){},"4ef0":function(e,t,a){"use strict";var i=a("1565"),l=a.n(i);l.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c"),a("f751"),a("097d");var i=a("2b0e"),l=a("5c96"),o=a.n(l),s=(a("0fae"),a("2f62"));i["default"].use(s["a"]);var r=new s["a"].Store({state:{url:"http://192.168.247.140:8080",test:"HELLO_WORLD",userName:"appUser",userCTF:{}},mutations:{},actions:{}}),n=a("8c4f"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("el-container",{staticStyle:{height:"100%"}},[a("el-header",{staticStyle:{height:"10%"}},[a("h1",[e._v("基于区块链的物联网认证系统")]),a("div",[a("i",{staticClass:"el-icon-user-solid userName"},[e._v(e._s(e.$store.state.userName))]),a("el-button",{staticClass:"logOut",attrs:{icon:"el-icon-switch-button",circle:""},on:{click:e.logOut}})],1)]),a("el-container",{staticStyle:{height:"90%"}},[a("el-aside",{attrs:{width:"15%"}},[a("el-menu",{attrs:{"default-active":e.active},on:{open:e.handleOpen,close:e.handleClose}},[a("router-link",{attrs:{to:"/home/network",tag:"span"}},[a("el-menu-item",{attrs:{index:"1"}},[a("i",{staticClass:"el-icon-cpu"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("网络概况")])])],1),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-menu"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("区块数据")])]),a("router-link",{attrs:{to:"/home/mspData",tag:"span"}},[a("el-menu-item",{attrs:{index:"2-1"}},[a("span",[e._v("组织信息")])])],1),a("router-link",{attrs:{to:"/home/deviceData",tag:"span"}},[a("el-menu-item",{attrs:{index:"2-2"}},[a("span",[e._v("设备信息")])])],1)],2),a("router-link",{attrs:{to:"/home/setting",tag:"span"}},[a("el-menu-item",{attrs:{index:"3"}},[a("i",{staticClass:"el-icon-setting"}),a("span",[e._v("用户设置")])])],1)],1)],1),a("el-container",{staticStyle:{height:"100%"}},[a("el-main",{staticStyle:{height:"90%"}},[a("router-view")],1),a("el-footer",{staticStyle:{height:"10%"}},[a("div",[e._v("@CopyRight 南京工业大学-计算机科学与技术学院-计算机科学与技术(嵌入式)-计软1701-陆于洋-1405170121")])])],1)],1)],1)],1)},d=[],u=(a("7f7f"),{name:"home",data:function(){return{active:"1"}},methods:{handleOpen:function(e,t){console.log(e,t)},handleClose:function(e,t){console.log(e,t)},logOut:function(){this.$router.push("/")}},mounted:function(){""==this.$store.state.userName&&(this.$message.error("请先登录"),this.$router.push("/login")),this.active=this.$route.name}}),p=u,m=(a("ee49"),a("2877")),h=Object(m["a"])(p,c,d,!1,null,"eebb2008",null),f=h.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"login"}},[a("el-container",{staticClass:"el-container"},[a("el-main",[a("el-form",{ref:"loginForm",attrs:{model:e.loginForm,"status-icon":"","label-position":"left","label-width":"20%"}},[a("h3",{staticClass:"title"},[e._v("基于区块链的物联网认证系统-客户端")]),a("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[a("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"用户名"},model:{value:e.loginForm.userName,callback:function(t){e.$set(e.loginForm,"userName",t)},expression:"loginForm.userName"}})],1),a("el-form-item",{attrs:{prop:"file",label:"证书文件"}},[a("el-input",{attrs:{type:"file",id:"file","auto-complete":"off",placeholder:"文件"},on:{change:e.selectFile},model:{value:e.loginForm.fileName,callback:function(t){e.$set(e.loginForm,"fileName",t)},expression:"loginForm.fileName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-document"},on:{click:e.openFile},slot:"append"},[e._v("显示内容")])],1)],1),a("el-form-item",{attrs:{"label-width":"0px"}},[a("el-button",{staticStyle:{width:"30%","margin-right":"10px"},attrs:{type:"primary",loading:e.isLogining},on:{click:e.login}},[e._v("登录")]),a("el-button",{staticStyle:{width:"30%"},attrs:{type:"danger"},on:{click:e.register}},[e._v("注册")])],1)],1)],1),a("el-footer",[a("div",[e._v("@CopyRight 南京工业大学-计算机科学与技术学院-计算机科学与技术(嵌入式)-计软1701-陆于洋-1405170121")])])],1),a("el-drawer",{attrs:{title:"文件内容",visible:e.showFileContent,direction:"rtl",size:"30%"},on:{"update:visible":function(t){e.showFileContent=t}}},[a("el-form",{attrs:{model:e.fileForm,"abel-position":"left","label-width":"auto"}},[a("el-form-item",{attrs:{prop:"certificate",label:"证书"}},[a("el-input",{attrs:{type:"textarea",rows:5,readonly:""},model:{value:e.fileForm.credentials.certificate,callback:function(t){e.$set(e.fileForm.credentials,"certificate",t)},expression:"fileForm.credentials.certificate"}})],1),a("el-form-item",{attrs:{prop:"privateKey",label:"私钥"}},[a("el-input",{attrs:{type:"textarea",rows:5,readonly:""},model:{value:e.fileForm.credentials.privateKey,callback:function(t){e.$set(e.fileForm.credentials,"privateKey",t)},expression:"fileForm.credentials.privateKey"}})],1),a("el-form-item",{attrs:{prop:"mspId",label:"组织ID"}},[a("el-input",{attrs:{type:"text",readonly:""},model:{value:e.fileForm.mspId,callback:function(t){e.$set(e.fileForm,"mspId",t)},expression:"fileForm.mspId"}})],1),a("el-form-item",{attrs:{prop:"type",label:"证书格式"}},[a("el-input",{attrs:{type:"text",readonly:""},model:{value:e.fileForm.type,callback:function(t){e.$set(e.fileForm,"type",t)},expression:"fileForm.type"}})],1)],1)],1)],1)},v=[],b={name:"login",data:function(){return{loginForm:{userName:"admin",fileName:""},fileForm:{credentials:{certificate:"",privateKey:""},mspId:"",type:""},showFileContent:!1,isLogining:!1}},methods:{login:function(e){var t=this;this.isLogining=!0;var a={enrollmentId:this.loginForm.userName,enrollmentWallet:this.fileForm};console.log(a),this.$axios.post(this.$store.state.url+"/users/login",a).then(function(e){t.isLogining=!1,200==e.data.code?(t.$message.success("登录成功"),t.$store.state.userName=t.loginForm.userName,t.$store.state.userCTF=t.fileForm,setTimeout(function(){t.$router.push("/home/network")},2e3)):t.$message.error("登录失败")})},register:function(e){var t=this,i=a("21a6"),l="";this.$prompt("请输入用户名","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(e){var a=e.value;l=a;var o=t.$loading({lock:!0,text:"注册中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t.$axios.post(t.$store.state.url+"/users/register",{enrollmentId:a}).then(function(e){if(console.log(e),o.close(),200==e.data.code){var s=JSON.stringify(e.data.data);t.$confirm("点击确认下载证书文件(用户:"+a+")","提示",{confirmButtonText:"确定",showCancelButton:!1,closeOnClickModal:!1,closeOnPressEscape:!1,type:"info"}).then(function(){var e=new Blob([s],{type:"text/plain;charset=utf-8"});i.saveAs(e,l+".id"),t.loginForm.userName=l})}else t.$message.error("注册失败")})}).catch(function(){loading.close(),t.$message.info("取消输入")})},selectFile:function(){var e=this,t=document.getElementById("file").files[0];if(""!=this.loginForm.fileName){var a=new FileReader;a.readAsText(t),a.onload=function(t){var a=JSON.parse(t.target.result);""!=a.credentials&&void 0!=a.credentials&&null!=a.credentials?e.fileForm=a:e.$message.error("文件格式不正确!")}}},openFile:function(){""==this.loginForm.fileName||""==this.loginForm.file?this.$message.error("请选择文件"):this.showFileContent=!0}},created:function(){var e=this;this.$axios.get(this.$store.state.url+"/","").then(function(t){200==t.data.code?e.$notify.success({title:"区块链网络",message:"已连上区块链网络!"}):e.$notify.error({title:"区块链网络",message:"无法连接区块链网络!"})}).catch(function(t){e.$notify.error({title:"区块链网络",message:"无法连接区块链网络!"})})}},y=b,$=(a("27bb"),Object(m["a"])(y,g,v,!1,null,"f9319cec",null)),x=$.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"left"}},[a("div",[a("el-divider",{attrs:{"content-position":"left"}},[e._v("当前用户")]),a("el-form",{staticStyle:{margin:"1% 2% 0% 2%",width:"50%"},attrs:{model:e.$store.state.userCTF,"abel-position":"left","label-width":"auto"}},[a("el-form-item",[a("el-tag",{attrs:{type:"danger"}},[e._v("所有设置均不可改变, 否则将导致CA认证失败!")])],1),a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{type:"text"},model:{value:e.$store.state.userName,callback:function(t){e.$set(e.$store.state,"userName",t)},expression:"$store.state.userName"}})],1),a("el-form-item",{attrs:{label:"证书"}},[a("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.$store.state.userCTF.credentials.certificate,callback:function(t){e.$set(e.$store.state.userCTF.credentials,"certificate",t)},expression:"$store.state.userCTF.credentials.certificate"}})],1),a("el-form-item",{attrs:{label:"私钥"}},[a("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.$store.state.userCTF.credentials.privateKey,callback:function(t){e.$set(e.$store.state.userCTF.credentials,"privateKey",t)},expression:"$store.state.userCTF.credentials.privateKey"}})],1),a("el-form-item",{attrs:{label:"组织ID"}},[a("el-input",{attrs:{type:"text"},model:{value:e.$store.state.userCTF.mspId,callback:function(t){e.$set(e.$store.state.userCTF,"mspId",t)},expression:"$store.state.userCTF.mspId"}})],1),a("el-form-item",{attrs:{label:"证书格式"}},[a("el-input",{attrs:{type:"text"},model:{value:e.$store.state.userCTF.type,callback:function(t){e.$set(e.$store.state.userCTF,"type",t)},expression:"$store.state.userCTF.type"}})],1)],1)],1),a("div",[a("el-divider",{attrs:{"content-position":"left"}},[e._v("当前服务器所有用户")]),a("el-row",{attrs:{gutter:5}},e._l(e.allUser,function(t,i){return a("el-col",{attrs:{span:4}},[a("el-tag",[e._v(e._s(t))])],1)}),1)],1)])},w=[],C={name:"setting",data:function(){return{allUser:[]}},methods:{getAllUser:function(){var e=this;this.$axios.get(this.$store.state.url+"/users/userList").then(function(t){200==t.data.code?e.allUser=t.data.data:console.log("获取所有用户失败")}).catch(function(e){console.log("获取所有用户失败")})}},created:function(){this.getAllUser()}},_=C,k=(a("e71e"),Object(m["a"])(_,D,w,!1,null,"58e05062",null)),B=k.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-divider",{attrs:{"content-position":"left"}},[e._v("区块信息")]),a("div",{staticClass:"selectBC"},[a("el-form",{attrs:{model:e.BCData,"abel-position":"left","label-width":"auto"}},[a("el-form-item",{attrs:{label:"区块号"}},[a("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.BCHeightLoading,expression:"BCHeightLoading"}],attrs:{placeholder:"请选择区块号"},model:{value:e.selectBC,callback:function(t){e.selectBC=t},expression:"selectBC"}},e._l(e.BCHeight,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}),1),a("el-tag",{staticStyle:{"margin-left":"1%"},attrs:{type:"info"}},[e._v("当前区块链高度: "+e._s(e.BCHeight))])],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.BCDataLoading,expression:"BCDataLoading"}],staticStyle:{width:"50%"}},[a("el-form-item",{attrs:{label:"当前区块数据部分Hash"}},[a("el-input",{directives:[{name:"loading",rawName:"v-loading"}],attrs:{type:"text",placeholder:"请选择区块号",readonly:""},model:{value:e.BCData.data_hash,callback:function(t){e.$set(e.BCData,"data_hash",t)},expression:"BCData.data_hash"}})],1),a("el-form-item",{attrs:{label:"前一区块头部Hash"}},[a("el-input",{attrs:{type:"text",placeholder:"请选择区块号",readonly:""},model:{value:e.BCData.previous_hash,callback:function(t){e.$set(e.BCData,"previous_hash",t)},expression:"BCData.previous_hash"}})],1)],1)],1)],1)],1),a("div",{staticStyle:{"margin-top":"5%"}},[a("el-divider",{attrs:{"content-position":"left"}},[e._v("节点信息")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.containerListLoading,expression:"containerListLoading"}],attrs:{data:e.containerList,border:"",stripe:"","highlight-current-row":"",lazy:""}},[a("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{fixed:"",prop:"name",label:"节点域名",sortable:""}}),a("el-table-column",{attrs:{prop:"type",label:"节点类型",width:"150",sortable:""}}),a("el-table-column",{attrs:{prop:"ip",label:"IP地址",width:"200",sortable:""}}),a("el-table-column",{attrs:{prop:"mac",label:"MAC地址",width:"200",sortable:""}}),a("el-table-column",{attrs:{prop:"desc",label:"描述",width:"200",sortable:""}})],1)],1)])},L=[],I={name:"network",data:function(){return{BCHeight:2,selectBC:"",BCData:{data_hash:"",previous_hash:""},newestBCData:{},BCDataLoading:!1,BCHeightLoading:!0,containerList:[{name:"",ip:"",mac:"",type:""}],containerListLoading:!0}},watch:{selectBC:"getBCData"},methods:{getBCData:function(){var e=this;this.BCDataLoading=!0,this.selectBC==this.BCHeight?(this.BCData.data_hash=this.newestBCData.currentBlockHash,this.BCData.previous_hash=this.newestBCData.previousBlockHash,this.BCDataLoading=!1):this.$axios.post(this.$store.state.url+"/option/getBCBlock",{blockNum:this.selectBC,type:"hash"}).then(function(t){e.BCDataLoading=!1,200==t.data.code?e.BCData=t.data.data:console.log("获取区块Hash失败")}).catch(function(t){e.BCDataLoading=!1,console.log("获取区块Hash失败")})},getBCHeight:function(){var e=this;this.BCHeightLoading=!0,this.$axios.get(this.$store.state.url+"/option/getBCHeight").then(function(t){e.BCHeightLoading=!1,200==t.data.code?(e.BCHeight=t.data.data.height,e.newestBCData=t.data.data):console.log("获取区块高度失败")}).catch(function(t){e.BCHeightLoading=!1,console.log("获取区块高度失败")})},getContainer:function(){var e=this;this.containerListLoading=!0,this.$axios.get(this.$store.state.url+"/option/getDocker").then(function(t){e.containerListLoading=!1,200==t.data.code?e.containerList=t.data.data:console.log("获取节点信息失败")}).catch(function(t){e.containerListLoading=!1,console.log("获取节点信息失败")})}},created:function(){this.getBCHeight(),this.getContainer()}},N=I,S=(a("6564"),Object(m["a"])(N,F,L,!1,null,"017e10a4",null)),O=S.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticClass:"add-button",attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){e.showAddDevice=!0}}}),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tableData,border:"",stripe:"","highlight-current-row":"",lazy:"","max-height":"550"}},[a("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{fixed:"",prop:"Key",label:"设备ID",width:"150",sortable:""}}),a("el-table-column",{attrs:{prop:"Record.msp",label:"所属组织",width:"150",sortable:""}}),a("el-table-column",{attrs:{prop:"Record.docType",label:"设备类型",width:"150",sortable:""}}),a("el-table-column",{attrs:{prop:"Record.data",label:"数据",width:"100",sortable:""}}),a("el-table-column",{attrs:{prop:"Record.unit",label:"数据单位",width:"100"}}),a("el-table-column",{attrs:{prop:"Record.timestamp",label:"时间戳",width:"150",sortable:""}}),a("el-table-column",{attrs:{prop:"Record.desc",label:"描述",sortable:""}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-search"},on:{click:function(a){return e.getHis(t.row.Key)}}},[e._v("查看历史数据")]),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.modify(t.row)}}},[e._v("修改")])]}}])})],1),a("el-drawer",{attrs:{title:"设备数据历史记录",visible:e.showDeviceHistory,direction:"ltr",size:"75%"},on:{"update:visible":function(t){e.showDeviceHistory=t}}},[a("h3",[e._v(e._s(e.selectDevice))]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.historyLoading,expression:"historyLoading"}],attrs:{data:e.historyData,border:"",stripe:"","highlight-current-row":"",lazy:"","max-height":"500"}},[a("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{property:"data",label:"数据",width:"100",sortable:""}}),a("el-table-column",{attrs:{property:"unit",label:"数据单位",width:"100"}}),a("el-table-column",{attrs:{property:"docType",label:"设备类型",width:"100"}}),a("el-table-column",{attrs:{property:"timestamp",label:"时间戳",width:"200",sortable:""}}),a("el-table-column",{attrs:{property:"desc",label:"描述",width:"200",sortable:""}}),a("el-table-column",{attrs:{property:"txId",label:"交易ID"}})],1)],1),a("el-drawer",{attrs:{title:"新增设备信息",visible:e.showAddDevice,direction:"ltr",size:"50%"},on:{"update:visible":function(t){e.showAddDevice=t}}},[a("el-form",{attrs:{model:e.deviceData,"label-position":"left","label-width":"auto"}},[a("el-form-item",{attrs:{label:"设备ID",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"以如下格式命名: 组织号-设备号",clearable:""},model:{value:e.deviceData.senId,callback:function(t){e.$set(e.deviceData,"senId",t)},expression:"deviceData.senId"}})],1),a("el-form-item",{attrs:{label:"设备类型"}},[a("el-input",{attrs:{type:"text",placeholder:"设备类型包括: temperature, humidity, pressure...",clearable:""},model:{value:e.deviceData.type,callback:function(t){e.$set(e.deviceData,"type",t)},expression:"deviceData.type"}})],1),a("el-form-item",{attrs:{label:"数据"}},[a("el-input",{attrs:{type:"text",clearable:""},model:{value:e.deviceData.data,callback:function(t){e.$set(e.deviceData,"data",t)},expression:"deviceData.data"}})],1),a("el-form-item",{attrs:{label:"数据单位"}},[a("el-input",{attrs:{type:"text",placeholder:"数据单位包括: C, %, MPa",clearable:""},model:{value:e.deviceData.unit,callback:function(t){e.$set(e.deviceData,"unit",t)},expression:"deviceData.unit"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入设备的描述信息",clearable:""},model:{value:e.deviceData.desc,callback:function(t){e.$set(e.deviceData,"desc",t)},expression:"deviceData.desc"}})],1)],1),a("div",[a("el-button",{on:{click:function(t){e.showAddDevice=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addDevice}},[e._v("确 定")])],1)],1)],1)},H=[],A=(a("28a5"),a("a481"),a("ac4d"),a("8a81"),a("ac6a"),{name:"deviceData",data:function(){return{tableData:[{Key:"",Record:{docType:"",data:"",unit:"",timestamp:":36:27.828Z",desc:""}}],selectDevice:"",historyData:[{docType:"",data:"",unit:"",timestamp:"",txId:"",desc:""}],deviceData:{senId:"",data:"",type:"",unit:"",desc:""},showDeviceHistory:!1,showAddDevice:!1,tableLoading:!0,historyLoading:!0,addDeviceLoading:!1}},methods:{getHis:function(e){var t=this;this.selectDevice=e,this.historyLoading=!0,this.showDeviceHistory=!0,this.$axios.post(this.$store.state.url+"/query/senhis",{enrollmentId:this.$store.state.userName,senId:e}).then(function(e){if(console.log(e.data),200==e.data.code){t.historyData=JSON.parse(JSON.stringify(e.data.data));var a=!0,i=!1,l=void 0;try{for(var o,s=t.historyData[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var r=o.value,n=r.timestamp.replace("T"," ");n=n.replace("Z",""),r.timestamp=n}}catch(c){i=!0,l=c}finally{try{a||null==s.return||s.return()}finally{if(i)throw l}}t.historyLoading=!1}else t.$message.error("获取数据失败!")}).catch(function(e){t.$message.error("获取数据失败!")})},modify:function(e){var t=this;this.selectDevice=e.Key,this.$prompt("请输入设备数据,设备ID("+e.Key+")","提示",{confirmButtonText:"提交",cancelButtonText:"取消",inputPlaceholder:e.Record.data}).then(function(a){var i=a.value,l=t.$loading({lock:!0,text:"提交中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t.$axios.post(t.$store.state.url+"/updateSen",{enrollmentId:t.$store.state.userName,senId:e.Key,data:i}).then(function(e){l.close(),200==e.data.code?(t.$message.success("修改数据成功!"),t.getDeviceData()):t.$message.error("修改数据失败!")}).catch(function(e){l.close(),t.$message.error("修改数据失败!")})}).catch(function(){t.$message({type:"info",message:"取消输入"})})},addDevice:function(){var e=this,t=this.$loading({lock:!0,text:"提交中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$axios.post(this.$store.state.url+"/addSen",{enrollmentId:this.$store.state.userName,senId:this.deviceData.senId,data:this.deviceData.data,type:this.deviceData.type,unit:this.deviceData.unit,desc:this.deviceData.desc}).then(function(a){console.log(a),t.close(),200==a.data.code?(e.$message.success("新增设备成功!"),e.getDeviceData(),e.showAddDevice=!1):e.$message.error("新增设备失败!")}).catch(function(a){t.close(),e.$message.error("新增设备失败,网络错误!")})},getDeviceData:function(){var e=this;this.tableLoading=!0,this.$axios.post(this.$store.state.url+"/query/allsens",{enrollmentId:this.$store.state.userName}).then(function(t){if(console.log(t.data),200==t.data.code){e.tableData=JSON.parse(JSON.stringify(t.data.data));var a=!0,i=!1,l=void 0;try{for(var o,s=e.tableData[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var r=o.value,n=r.Record.timestamp.replace("T"," ");n=n.replace("Z",""),r.Record.timestamp=n,r.Record.msp=r.Key.split("-")[0]}}catch(c){i=!0,l=c}finally{try{a||null==s.return||s.return()}finally{if(i)throw l}}e.tableLoading=!1}else e.$message.error("获取数据失败!")}).catch(function(t){e.$message.error("获取数据失败!")})}},created:function(){this.getDeviceData()}}),M=A,P=(a("8b25"),Object(m["a"])(M,T,H,!1,null,"424e2198",null)),j=P.exports,K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-button",{staticClass:"add-button",attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:function(t){e.showAddMSP=!0}}}),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.tableData,border:"",stripe:"","highlight-current-row":"",lazy:"","max-height":"550"}},[a("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{fixed:"",prop:"mspId",label:"组织ID",width:"150",sortable:""}}),a("el-table-column",{attrs:{fixed:"",prop:"children",label:"包含设备"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,function(t,i){return a("el-tag",[e._v(e._s(t))])})}}])}),a("el-table-column",{attrs:{prop:"desc",label:"描述",width:"200",sortable:""}}),a("el-table-column",{attrs:{prop:"timestamp",label:"时间戳",width:"200",sortable:""}})],1),a("el-drawer",{attrs:{title:"新增设备信息",visible:e.showAddMSP,direction:"ltr",size:"50%"},on:{"update:visible":function(t){e.showAddMSP=t}}},[a("el-form",{attrs:{model:e.mspData,"label-position":"left","label-width":"auto"}},[a("el-form-item",{attrs:{label:"组织ID",required:""}},[a("el-input",{attrs:{type:"text",placeholder:"以如下格式命名: org[数字]",clearable:""},model:{value:e.mspData.mspId,callback:function(t){e.$set(e.mspData,"mspId",t)},expression:"mspData.mspId"}})],1),a("el-form-item",{attrs:{label:"包含传感器"}},[a("el-input",{attrs:{type:"text",placeholder:"请至设备信息处新增传感器",readonly:""},model:{value:e.mspData.children,callback:function(t){e.$set(e.mspData,"children",t)},expression:"mspData.children"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入组织的描述信息",clearable:""},model:{value:e.mspData.desc,callback:function(t){e.$set(e.mspData,"desc",t)},expression:"mspData.desc"}})],1)],1),a("div",[a("el-button",{on:{click:function(t){e.showAddMSP=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addMSP}},[e._v("确 定")])],1)],1)],1)},R=[],z={name:"mspData",data:function(){return{tableData:[{mspId:"",children:[],desc:"",timestamp:""}],mspData:{mspId:"",children:"",desc:""},tableLoading:!0,showAddMSP:!1}},methods:{addMSP:function(){var e=this,t=this.$loading({lock:!0,text:"提交中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$axios.post(this.$store.state.url+"/addOrg",{enrollmentId:this.$store.state.userName,mspId:this.mspData.mspId,children:this.mspData.children,desc:this.mspData.desc}).then(function(a){console.log(a),t.close(),200==a.data.code?(e.$message.success("新增组织成功!"),e.getMspData(),e.showAddMSP=!1):e.$message.error("新增组织失败!")}).catch(function(a){t.close(),e.$message.error("新增组织失败,网络错误!")})},getMspData:function(){var e=this;this.tableLoading=!0,this.$axios.post(this.$store.state.url+"/query/msps",{enrollmentId:this.$store.state.userName}).then(function(t){if(console.log(t.data),e.tableLoading=!1,200==t.data.code){e.tableData=JSON.parse(JSON.stringify(t.data.data));var a=!0,i=!1,l=void 0;try{for(var o,s=e.tableData[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var r=o.value,n=r.timestamp.replace("T"," ");n=n.replace("Z",""),r.timestamp=n}}catch(c){i=!0,l=c}finally{try{a||null==s.return||s.return()}finally{if(i)throw l}}}else e.$message.error("获取数据失败!")}).catch(function(t){e.tableLoading=!1,e.$message.error("获取数据失败!")})}},created:function(){this.getMspData()}},E=z,J=(a("4ef0"),Object(m["a"])(E,K,R,!1,null,"5954fbe3",null)),U=J.exports;i["default"].use(n["a"]);var q=[{path:"/",redirect:"login"},{path:"/login",component:x},{path:"/home",component:f,name:"1",children:[{path:"/home/setting",component:B,name:"3"},{path:"/home/network",component:O,name:"1"},{path:"/home/deviceData",component:j,name:"2-2"},{path:"/home/mspData",component:U,name:"2-1"}]}],Z=new n["a"]({routes:q,mode:"history"}),W=Z,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},Q=[],V={name:"app"},X=V,Y=(a("034f"),Object(m["a"])(X,G,Q,!1,null,null,null)),ee=Y.exports,te=a("bc3a"),ae=a.n(te);i["default"].config.productionTip=!1,i["default"].use(o.a),i["default"].prototype.$axios=ae.a,new i["default"]({el:"#app",render:function(e){return e(ee)},store:r,router:W})},"64a9":function(e,t,a){},6564:function(e,t,a){"use strict";var i=a("66f6"),l=a.n(i);l.a},"66f6":function(e,t,a){},"8b1a":function(e,t,a){},"8b25":function(e,t,a){"use strict";var i=a("19e7"),l=a.n(i);l.a},e71e:function(e,t,a){"use strict";var i=a("44ee"),l=a.n(i);l.a},ee49:function(e,t,a){"use strict";var i=a("8b1a"),l=a.n(i);l.a}});
//# sourceMappingURL=app.780d03c3.js.map